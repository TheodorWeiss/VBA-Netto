Sub KeepOnlySelectedCities()
    Dim ws As Worksheet
    Dim lastRow As Long, r As Long
    Dim startRow As Long, endRow As Long
    Dim headerColor As Long
    Dim cityList As Variant
    
    ' список городов, которые нужно оставить
    cityList = Array("Berlin", "München")
    
    Set ws = ThisWorkbook.Worksheets("Werbung")
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' цвет заголовков
    For r = 1 To lastRow
        If Len(Trim$(ws.Cells(r, 1).Value)) > 0 Then
            headerColor = ws.Cells(r, 1).Interior.Color
            Exit For
        End If
    Next r
    
    Application.ScreenUpdating = False
    
    ' идём снизу вверх
    For r = lastRow To 1 Step -1
        If ws.Cells(r, 1).Interior.Color = headerColor Then
            startRow = r
            endRow = lastRow + 1
            Dim rr As Long
            For rr = r + 1 To lastRow
                If ws.Cells(rr, 1).Interior.Color = headerColor Then
                    endRow = rr
                    Exit For
                End If
            Next rr
            ' если города нет в списке → удаляем
            If Not IsInArray(Trim$(ws.Cells(r, 1).Value), cityList) Then
                ws.Rows(startRow & ":" & endRow - 1).Delete
                lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
            End If
        End If
    Next r
    
    Application.ScreenUpdating = True
End Sub
